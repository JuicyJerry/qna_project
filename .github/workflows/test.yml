# 깃헙이 야물 파일 읽어 판단
# steps: 파이프 라인 정의

name: test
on:
    push:
        branches: [dev]
    pull_request:
        branches: [dev, main]
jobs:
    test:
        runs-on: ubuntu-24.04
        steps:
            - name: Checkout repository
              uses: actions/checkout@v3
            - name: Node.js setup
              uses: actions/setup-node@v3
              with:
                  node-version: "18"
            - name: Install npm packages
              run: npm ci
              working-directory: ./backend
            - name: install and run redis-server
              run: |
                  sudo apt-get update
                  sudo apt-get install -y redis-server
                  redis-server --daemonize yes --requirepass test_env --port 6380
              working-directory: ./backend
            - name: Run test
              run: npm run test:ci
              working-directory: ./backend
            - name: test build
              run: npm run build
              working-directory: ./backend
